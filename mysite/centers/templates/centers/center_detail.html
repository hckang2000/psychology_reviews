<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ center.name }}</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'centers/styles.css' %}">
</head>
<body>

<!-- Image Slider Section -->
<div id="image-slider" class="slider-container">
    {% for image in center.images.all %}
    <div class="slide">
        <img src="{{ image.image.url }}" alt="Facility image for {{ center.name }}">
    </div>
    {% endfor %}
</div>

<!-- Slider Navigation Controls -->
<div class="slider-nav">
    <button class="prev" onclick="moveSlide(-1)">&#10094;</button>
    <button class="next" onclick="moveSlide(1)">&#10095;</button>
</div>

<!-- Main Center Information -->
<div id="center-info">
    <h2>{{ center.name }}</h2>
    <p>{{ center.description }}</p>
    <p><strong>Address:</strong> {{ center.address }}</p>
    <p><strong>Contact:</strong> {{ center.contact }}</p>
    <p><strong>Website:</strong> <a href="{{ center.url }}" target="_blank">{{ center.url }}</a></p>

    {% if user.is_authenticated %}
        <button id="write-review-btn">Write a Review</button>
    {% else %}
        <p><a href="{% url 'login' %}">Log in</a> to write a review.</p>
    {% endif %}
</div>

<div id="review-form-container" style="display:none;">
    <h3>Write a Review</h3>
    <form method="POST">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Submit Review</button>
    </form>
</div>

<div id="reviews">
    <h3>Reviews</h3>
    {% for review in reviews %}
    <div class="review">
        <h3>{{ review.title }}</h3>
        <p>{{ review.summary }}</p>
        <p><small>{{ review.date }}</small></p>
        {% if review.has_url %}
            <a href="{{ review.url }}" target="_blank">Read more</a>
        {% endif %}
    </div>
    {% endfor %}
</div>

<!-- Slider functionality -->
<script>
    let currentSlideIndex = 0;
    const slides = document.querySelectorAll('.slide');

    function showSlide(index) {
        // Hide all slides
        slides.forEach((slide) => {
            slide.style.display = 'none';
        });

        // Show the selected slide
        slides[index].style.display = 'block';
    }

    function moveSlide(direction) {
        currentSlideIndex += direction;

        // Wrap around if we go past the last slide
        if (currentSlideIndex >= slides.length) {
            currentSlideIndex = 0;
        }

        // Wrap around if we go before the first slide
        if (currentSlideIndex < 0) {
            currentSlideIndex = slides.length - 1;
        }

        showSlide(currentSlideIndex);
    }

    // Show the first slide when the page loads
    document.addEventListener('DOMContentLoaded', function() {
        showSlide(currentSlideIndex);
    });
</script>

<!-- Toggle review form -->
<script>
    document.getElementById('write-review-btn').onclick = function() {
        var formContainer = document.getElementById('review-form-container');
        if (formContainer.style.display === 'none') {
            formContainer.style.display = 'block';
        } else {
            formContainer.style.display = 'none';
        }
    };
</script>

</body>
</html>
