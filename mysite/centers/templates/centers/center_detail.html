<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ center.name }}</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'centers/styles.css' %}">
    <!-- Swiper.js CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
</head>
<body>

<!-- Image Slider Section -->
<div class="swiper-container max-w-screen-md mx-auto">
    <div class="swiper-wrapper">
        {% for image in center.images.all %}
        <div class="swiper-slide">
            <div class="image-container">
                <img src="{{ image.image.url }}" alt="Facility image for {{ center.name }}">
            </div>
        </div>
        {% endfor %}
    </div>
    <!-- Slider Navigation Controls -->
    <div class="swiper-button-next"></div>
    <div class="swiper-button-prev"></div>
    <!-- Pagination -->
    <div class="swiper-pagination"></div>
</div>

<!-- Main Center Information -->
<div id="center-info" class="max-w-screen-md mx-auto p-6">
    <h2 class="text-3xl font-bold mb-4">{{ center.name }}</h2>
    <div class="mb-6">
        <p class="mb-2"><strong>주소:</strong> {{ center.address }}</p>
        <p class="mb-2"><strong>연락처:</strong> {{ center.contact }}</p>
        {% if center.url %}
        <p class="mb-4"><strong>웹사이트:</strong> <a href="{{ center.url }}" target="_blank" class="text-blue-600 hover:text-blue-800">{{ center.url }}</a></p>
        {% endif %}
        <p class="text-gray-700">{{ center.description }}</p>
    </div>

    <!-- Therapist Section -->
    <div class="therapist-section mb-8">
        <h3 class="text-2xl font-semibold mb-4">상담사 소개</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {% for therapist in center.therapists.all %}
            <div class="therapist-card bg-white rounded-lg shadow-md overflow-hidden">
                <div class="aspect-square overflow-hidden bg-blue-500">
                    {% if therapist.photo %}
                    <img src="{{ therapist.photo.url }}" alt="{{ therapist.name }}" class="w-full h-full object-cover">
                    {% else %}
                    <div class="w-full h-full flex items-center justify-center text-white text-2xl font-bold">
                        상담사<br>사진
                    </div>
                    {% endif %}
                </div>
                <div class="p-4">
                    <h4 class="text-xl font-semibold mb-2">{{ therapist.name }}</h4>
                    <p class="text-gray-600 mb-1">경력: {{ therapist.experience }}년</p>
                    <p class="text-gray-600">전문 분야: {{ therapist.specialty }}</p>
                </div>
            </div>
            {% empty %}
            <p class="col-span-full text-gray-500 text-center">등록된 상담사가 없습니다.</p>
            {% endfor %}
        </div>
    </div>

    {% if user.is_authenticated %}
        <button id="write-review-btn">Write a Review</button>
    {% else %}
        <p><a href="{% url 'login' %}">Log in</a> to write a review.</p>
    {% endif %}
</div>

<div id="review-form-container" style="display:none;">
    <h3>Write a Review</h3>
    <form method="POST">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Submit Review</button>
    </form>
</div>

<div id="reviews">
    <h3>Reviews</h3>
    {% for review in reviews %}
    <div class="review">
        <h3>{{ review.title }}</h3>
        <p>{{ review.summary }}</p>
        <p><small>{{ review.date }}</small></p>
        {% if review.has_url %}
            <a href="{{ review.url }}" target="_blank">Read more</a>
        {% endif %}
    </div>
    {% endfor %}
</div>

<!-- Swiper.js JS -->
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script>
    // Initialize Swiper
    const swiper = new Swiper('.swiper-container', {
        // Optional parameters
        direction: 'horizontal',
        loop: true,
        
        // If we need pagination
        pagination: {
            el: '.swiper-pagination',
            clickable: true,
        },
        
        // Navigation arrows
        navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
        },
        
        // Responsive breakpoints
        breakpoints: {
            // when window width is >= 320px
            320: {
                slidesPerView: 1,
                spaceBetween: 10
            },
            // when window width is >= 480px
            480: {
                slidesPerView: 1,
                spaceBetween: 20
            },
            // when window width is >= 640px
            640: {
                slidesPerView: 1,
                spaceBetween: 30
            },
            // when window width is >= 768px
            768: {
                slidesPerView: 1,
                spaceBetween: 40
            }
        }
    });
</script>

<!-- Toggle review form -->
<script>
    document.getElementById('write-review-btn').onclick = function() {
        var formContainer = document.getElementById('review-form-container');
        if (formContainer.style.display === 'none') {
            formContainer.style.display = 'block';
        } else {
            formContainer.style.display = 'none';
        }
    };
</script>

</body>
</html>
